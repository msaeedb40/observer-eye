# Generated by Django 6.0.1 on 2026-02-06 16:24

import django.db.models.deletion
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('traffic', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AlterField(
            model_name='loadbalancerstats',
            name='created_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AlterField(
            model_name='routeanalytics',
            name='created_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AlterField(
            model_name='trafficstats',
            name='created_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL),
        ),
        migrations.CreateModel(
            name='FrontendError',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('session_id', models.CharField(db_index=True, max_length=64)),
                ('page_url', models.URLField(max_length=2048)),
                ('error_type', models.CharField(db_index=True, max_length=100)),
                ('error_message', models.TextField()),
                ('stack_trace', models.TextField(blank=True)),
                ('filename', models.CharField(blank=True, max_length=512)),
                ('line_number', models.IntegerField(blank=True, null=True)),
                ('column_number', models.IntegerField(blank=True, null=True)),
                ('browser', models.CharField(blank=True, max_length=100)),
                ('os', models.CharField(blank=True, max_length=100)),
                ('error_hash', models.CharField(db_index=True, max_length=64)),
                ('occurrences', models.IntegerField(default=1)),
                ('first_seen', models.DateTimeField(auto_now_add=True)),
                ('last_seen', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Frontend Error',
                'verbose_name_plural': 'Frontend Errors',
                'ordering': ['-last_seen'],
            },
        ),
        migrations.CreateModel(
            name='ResourceTiming',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('session_id', models.CharField(db_index=True, max_length=64)),
                ('page_url', models.URLField(max_length=2048)),
                ('resource_url', models.URLField(max_length=2048)),
                ('resource_type', models.CharField(choices=[('script', 'Script'), ('stylesheet', 'Stylesheet'), ('image', 'Image'), ('font', 'Font'), ('xhr', 'XHR'), ('fetch', 'Fetch'), ('other', 'Other')], db_index=True, max_length=20)),
                ('start_time_ms', models.FloatField()),
                ('duration_ms', models.FloatField()),
                ('dns_time_ms', models.FloatField(default=0)),
                ('connect_time_ms', models.FloatField(default=0)),
                ('ssl_time_ms', models.FloatField(default=0)),
                ('ttfb_ms', models.FloatField(default=0)),
                ('download_time_ms', models.FloatField(default=0)),
                ('transfer_size_bytes', models.IntegerField(default=0)),
                ('encoded_body_size', models.IntegerField(default=0)),
                ('decoded_body_size', models.IntegerField(default=0)),
                ('response_status', models.IntegerField(blank=True, null=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Resource Timing',
                'verbose_name_plural': 'Resource Timings',
            },
        ),
        migrations.CreateModel(
            name='SyntheticMonitor',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('name', models.CharField(max_length=255)),
                ('url', models.URLField(max_length=2048)),
                ('check_type', models.CharField(choices=[('http', 'HTTP/HTTPS'), ('ssl', 'SSL/TLS Certificate'), ('dns', 'DNS Resolution'), ('tcp', 'TCP Port'), ('ping', 'ICMP Ping'), ('browser', 'Managed Browser')], default='http', max_length=50)),
                ('method', models.CharField(choices=[('GET', 'GET'), ('POST', 'POST'), ('PUT', 'PUT'), ('DELETE', 'DELETE'), ('HEAD', 'HEAD')], default='GET', max_length=10)),
                ('headers', models.JSONField(blank=True, default=dict)),
                ('body', models.TextField(blank=True)),
                ('interval_seconds', models.IntegerField(default=60)),
                ('timeout_seconds', models.IntegerField(default=30)),
                ('locations', models.JSONField(default=list)),
                ('assertions', models.JSONField(default=list)),
                ('is_active', models.BooleanField(default=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Synthetic Monitor',
                'verbose_name_plural': 'Synthetic Monitors',
            },
        ),
        migrations.CreateModel(
            name='SyntheticResult',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('location', models.CharField(max_length=100)),
                ('status', models.CharField(choices=[('success', 'Success'), ('failure', 'Failure'), ('timeout', 'Timeout'), ('error', 'Script Error')], db_index=True, max_length=20)),
                ('response_time_ms', models.FloatField()),
                ('dns_time_ms', models.FloatField(blank=True, null=True)),
                ('connect_time_ms', models.FloatField(blank=True, null=True)),
                ('tls_time_ms', models.FloatField(blank=True, null=True)),
                ('ttfb_ms', models.FloatField(blank=True, null=True)),
                ('download_time_ms', models.FloatField(blank=True, null=True)),
                ('http_status_code', models.IntegerField(blank=True, null=True)),
                ('body_size_bytes', models.IntegerField(blank=True, null=True)),
                ('error_message', models.TextField(blank=True)),
                ('screenshot_url', models.URLField(blank=True, max_length=2048)),
                ('trace_id', models.CharField(blank=True, max_length=64)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('monitor', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='results', to='traffic.syntheticmonitor')),
            ],
            options={
                'verbose_name': 'Synthetic Result',
                'verbose_name_plural': 'Synthetic Results',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='UserSession',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('session_id', models.CharField(db_index=True, max_length=64, unique=True)),
                ('user_id', models.CharField(blank=True, db_index=True, max_length=255)),
                ('started_at', models.DateTimeField(auto_now_add=True)),
                ('ended_at', models.DateTimeField(blank=True, null=True)),
                ('duration_seconds', models.IntegerField(default=0)),
                ('page_views', models.IntegerField(default=0)),
                ('interactions', models.IntegerField(default=0)),
                ('errors_count', models.IntegerField(default=0)),
                ('entry_page', models.CharField(blank=True, max_length=512)),
                ('exit_page', models.CharField(blank=True, max_length=512)),
                ('referrer', models.URLField(blank=True, max_length=2048)),
                ('device_type', models.CharField(default='desktop', max_length=20)),
                ('browser', models.CharField(blank=True, max_length=100)),
                ('os', models.CharField(blank=True, max_length=100)),
                ('country_code', models.CharField(blank=True, max_length=2)),
                ('is_bounce', models.BooleanField(default=False)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'User Session',
                'verbose_name_plural': 'User Sessions',
                'ordering': ['-started_at'],
            },
        ),
        migrations.CreateModel(
            name='PageView',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('page_url', models.URLField(max_length=2048)),
                ('page_path', models.CharField(db_index=True, max_length=512)),
                ('page_title', models.CharField(blank=True, max_length=512)),
                ('load_time_ms', models.IntegerField(default=0)),
                ('time_on_page_seconds', models.IntegerField(default=0)),
                ('scroll_depth_percent', models.IntegerField(default=0)),
                ('clicks', models.IntegerField(default=0)),
                ('previous_page', models.CharField(blank=True, max_length=512)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('session', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='page_view_set', to='traffic.usersession')),
            ],
            options={
                'verbose_name': 'Page View',
                'verbose_name_plural': 'Page Views',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='CoreWebVitals',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('session_id', models.CharField(db_index=True, max_length=64)),
                ('page_url', models.URLField(db_index=True, max_length=2048)),
                ('page_path', models.CharField(db_index=True, max_length=512)),
                ('lcp_ms', models.FloatField(blank=True, help_text='Largest Contentful Paint (ms)', null=True)),
                ('fid_ms', models.FloatField(blank=True, help_text='First Input Delay (ms)', null=True)),
                ('cls', models.FloatField(blank=True, help_text='Cumulative Layout Shift', null=True)),
                ('inp_ms', models.FloatField(blank=True, help_text='Interaction to Next Paint (ms)', null=True)),
                ('ttfb_ms', models.FloatField(blank=True, help_text='Time to First Byte (ms)', null=True)),
                ('fcp_ms', models.FloatField(blank=True, help_text='First Contentful Paint (ms)', null=True)),
                ('dom_interactive_ms', models.FloatField(blank=True, null=True)),
                ('dom_complete_ms', models.FloatField(blank=True, null=True)),
                ('load_event_ms', models.FloatField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True)),
                ('browser', models.CharField(blank=True, max_length=100)),
                ('browser_version', models.CharField(blank=True, max_length=50)),
                ('os', models.CharField(blank=True, max_length=100)),
                ('device_type', models.CharField(choices=[('desktop', 'Desktop'), ('mobile', 'Mobile'), ('tablet', 'Tablet')], default='desktop', max_length=20)),
                ('connection_type', models.CharField(blank=True, max_length=20)),
                ('effective_bandwidth_mbps', models.FloatField(blank=True, null=True)),
                ('country_code', models.CharField(blank=True, max_length=2)),
                ('region', models.CharField(blank=True, max_length=100)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Core Web Vitals',
                'verbose_name_plural': 'Core Web Vitals',
                'indexes': [models.Index(fields=['page_path', 'created_at'], name='traffic_cor_page_pa_c35308_idx'), models.Index(fields=['device_type', 'created_at'], name='traffic_cor_device__9bcb17_idx')],
            },
        ),
    ]
